<!DOCTYPE html><html lang="en"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>A workaround for R-Grass GIS 7 (co-interface) users in Mac OSX | Avit Bhowmik | Environmental Scientist ¬∑ Climate Solutionist</title><meta name="description" content="Avit Bhowmik is the Research Director of Centre for Research on Sustainable Societal Transformation in Karlstad University "><meta itemprop="name" content="Avit Bhowmik"><meta itemprop="description" content="Avit Bhowmik is the Research Director of Centre for Research on Sustainable Societal Transformation in Karlstad University "><meta itemprop="image" content="http://avitbhowmik.ml/assets/images/rgrass.jpg"><meta property="og:url" content="http://avitbhowmik.ml/2016/07/04/dyld_grass/"><meta property="og:type" content="website"><meta property="og:title" content="A workaround for R-Grass GIS 7 (co-interface) users in Mac OSX | Avit Bhowmik | Environmental Scientist ¬∑ Climate Solutionist"><meta property="og:site_name" content="Avit Bhowmik | Environmental Scientist ¬∑ Climate Solutionist"><meta property="og:description" content="Avit Bhowmik is the Research Director of Centre for Research on Sustainable Societal Transformation in Karlstad University "><meta property="og:image" content="http://avitbhowmik.ml/assets/images/rgrass.jpg"><meta name="twitter:url" content="http://avitbhowmik.ml/2016/07/04/dyld_grass/"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="A workaround for R-Grass GIS 7 (co-interface) users in Mac OSX | Avit Bhowmik | Environmental Scientist ¬∑ Climate Solutionist"><meta name="twitter:site" content="Avit Bhowmik | Environmental Scientist ¬∑ Climate Solutionist"><meta name="twitter:description" content="Avit Bhowmik is the Research Director of Centre for Research on Sustainable Societal Transformation in Karlstad University "><meta name="twitter:creator" content="@avitbhowmik"><meta property="twitter:image" content="http://avitbhowmik.ml/assets/images/rgrass.jpg"><link rel="icon" type="image/x-icon" href="/assets/images/favicon.ico"><link rel="stylesheet" href="/assets/css/app.min.css"><link rel="alternate" type="application/rss+xml" title="Avit Bhowmik | Environmental Scientist ¬∑ Climate Solutionist" href="/feed.xml"><link rel="canonical" href="/2016/07/04/dyld_grass/"> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-70156509-1', 'auto'); ga('send', 'pageview'); </script></head><body id="a-workaround-for-r-grass-gis-7-co-interface-users-in-mac-osx" class="post-layout"><header class="header" style="background-color:#F7DC6F;"> <a class="header__title" href="http://avitbhowmik.ml/">Avit Bhowmik | Environmental Scientist ¬∑ Climate Solutionist</a><nav><ul class="header__list"><li><a href="/about">about</a></li><li><a href="/research">research</a></li><li><a href="/teaching">teaching</a></li><li><a href="/">outreach</a></li><li><span class="popup__open">contact</span></li></ul></nav></header><main class="üíà"><div class="post"><article itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting"><div class="post__header section-padding--double"><div class="grid-small"><h2 itemprop="name headline">A workaround for R-Grass GIS 7 (co-interface) users in Mac OSX</h2><time class="post__date" datetime="2016-07-04T00:00:00+02:00" itemprop="datePublished">4 Jul 2016</time></div></div><div class="post__img"><div><figure class="absolute-bg" style="background-image: url('/assets/images/rgrass.jpg');"></figure></div></div><p align="right"><em align="right">Image: OS Geo&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</em></p><div class="post__content section-padding"><div class="grid"><div id="markdown" itemprop="articleBody"><p>A new stable version of <a href="https://grass.osgeo.org/">GRASS GIS</a>, i.e. GRASS 7.0.4, has been released on May 2, 2016. Although a range of attractive features have been released along with the new version, an update of the existing version across operating systems is, as usual, a troubleshooting. Particularly, Mac users with the latest OSX ‚ÄúEl Capitan‚Äù have reported a few problems with updating to and running GRASS GIS 7. In addition, R-GRASS GIS co-interface users like myself, who wants to take advantage of the modules available in both software packages, may have faced some problems with associated python libraries. Below are the problems that I faced while updating to GRASS GIS 7 and co-interfacing with R via <a href="https://cran.r-project.org/web/packages/rgrass7/index.html">‚Äúrgrass 7‚Äù</a> package (thanks to Roger Bivand).</p><h4 id="grass-gis-7-does-not-run-on-osx-el-capitan-because-of-the-new-system-integrity-protection-feature">GRASS GIS 7 does not run on OSX ‚ÄúEl Capitan‚Äù because of the new ‚ÄúSystem Integrity Protection‚Äù feature</h4><p>The first problem was with installing and running GRASS 7 on El Capitan. The new System Integrity Protection (SIP) feature prevents GRASS installation as well as running, and hence, SIP needs to be disabled. Michael Barton has documented the procedure for GRASS installation by disabling SIP <a href="http://grassmac.wikidot.com/">here</a> that has solved my problem.</p><h4 id="grass-does-not-understand-locale-utf-8">GRASS does not understand locale UTF-8</h4><p>The second problem was GRASS failing to understand UTF-8 locale (perhaps because of my default Swedish locale) and consequently not parsing ‚Äúg.proj‚Äù with the following error.</p><figure class="highlight"><pre><code class="language-shell" data-lang="shell">ValueError: unknown locale: UTF-8</code></pre></figure><p>The workaround is easy. Create a <code class="highlighter-rouge">.bash_profile</code> file (unless you already have one) and add the locale information there. You can run the following code-snippets in R interface.</p><figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">system</span><span class="p">(</span><span class="s2">"cd ~/"</span><span class="p">)</span><span class="w">

</span><span class="n">system</span><span class="p">(</span><span class="s2">"touch .bash_profile"</span><span class="p">)</span><span class="w">

</span><span class="n">system</span><span class="p">(</span><span class="s2">"open -e .bash_profile"</span><span class="p">)</span></code></pre></figure><p>This will open the <code class="highlighter-rouge">.bash_profile</code> in your text editor. Add the following lines and save it.</p><figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">export</span> <span class="n">LC_ALL</span><span class="o">=</span><span class="n">en_US</span><span class="p">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>

<span class="n">export</span> <span class="n">LANG</span><span class="o">=</span><span class="n">en_US</span><span class="p">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span></code></pre></figure><h4 id="initiation-of-grass-gis-7-from-r-interface-fails-because-grass-fails-to-symlink-a-python-library">Initiation of GRASS GIS 7 from R interface fails because GRASS fails to symlink a python library</h4><p>This is a particular problem for the R-GRASS co-interface users. GRASS needs a dynamic link (dyld or symlink) to a python library, i.e. libintl.8.dylib, which is located in <code class="highlighter-rouge">/usr/local/lib</code>.</p><p>GRASS library location: <code class="highlighter-rouge">/Applications/GRASS-7.0.app/Contents/MacOS/lib</code>.</p><p>Originally the link is missing and users end up with the following error while initiating GRASS from R interface.</p><figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">dyld</span><span class="o">:</span><span class="w"> </span><span class="n">Library</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">loaded</span><span class="o">:</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">libintl.8.dylib</span><span class="w">
  </span><span class="n">Referenced</span><span class="w"> </span><span class="n">from</span><span class="o">:</span><span class="w"> </span><span class="o">/</span><span class="n">Applications</span><span class="o">/</span><span class="n">GRASS</span><span class="m">-7.0</span><span class="n">.app</span><span class="o">/</span><span class="n">Contents</span><span class="o">/</span><span class="n">MacOS</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">libgrass_gis.7.0.4.dylib</span><span class="w">
  </span><span class="n">Reason</span><span class="o">:</span><span class="w"> </span><span class="n">image</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">found</span></code></pre></figure><p>The solution of straightforward symlinking provided in the <a href="https://grasswiki.osgeo.org/wiki/R_statistics/Installation">grasswiki</a>:</p><figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">system</span><span class="p">(</span><span class="s2">"sudo ln -s /Applications/GRASS-7.0.app/Contents/MacOS/lib/libintl.8.dylib /usr/local/lib/libintl.8.dylib"</span><span class="p">)</span></code></pre></figure><p>does not work because a proper symlink to the <code class="highlighter-rouge">FFTW3.framework</code> is needed. Executing the following code snippets in R interface before initiating GRASS will solve the problem.</p><figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="nf">switch</span><span class="p">(</span><span class="w">
    </span><span class="n">Sys.info</span><span class="p">()[[</span><span class="s1">'sysname'</span><span class="p">]],</span><span class="w">
    </span><span class="n">Windows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s2">"I'm a Windows PC."</span><span class="p">)</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="n">Linux</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s2">"I'm a Penguin."</span><span class="p">)</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="n">Darwin</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s2">"I'm a Mac."</span><span class="p">);</span><span class="w">
    </span><span class="n">Sys.setenv</span><span class="p">(</span><span class="w"> </span><span class="n">DYLD_LIBRARY_PATH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="w">
    </span><span class="s2">"/Applications/GRASS-7.0.app/Contents/MacOS/lib"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"/Users/(username)/Library/GRASS/7.0/Modules/lib"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"/Library/GRASS/7.0/Modules/lib"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"/Applications/GRASS-7.0.app/Contents/MacOS/lib/FFTW3.framework/Versions/3"</span><span class="p">,</span><span class="w">
    </span><span class="s2">":DYLD_LIBRARY_PATH"</span><span class="p">,</span><span class="w">
    </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">":"</span><span class="w">
                    </span><span class="p">)</span><span class="w">
              </span><span class="p">)</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">)</span></code></pre></figure><p>I hope that this would solve the R-GRASS problems for Mac users. These were prerequisites for running <a href="https://github.com/AvitBhowmik/ATRIC">ATRIC</a> in Mac as well. I am currently updating ATRIC for GRASS GIS 7 with the help of a master‚Äôs student and will release soon.</p></div><ul class="post__social"><li><a href="https://www.facebook.com/sharer/sharer.php?u=http://avitbhowmik.ml/2016/07/04/dyld_grass/" target="_blank"><i class="fa fa-facebook"></i></a></li><li><a href="https://twitter.com/intent/tweet?&text=A workaround for R-Grass GIS 7 (co-interface) users in Mac OSX+http://avitbhowmik.ml/2016/07/04/dyld_grass/+by+Avit K. Bhowmik" target="_blank"><i class="fa fa-twitter"></i></a></li><li><a href="https://plus.google.com/share?url=http://avitbhowmik.ml/2016/07/04/dyld_grass/" target="_blank"><i class="fa fa-google-plus"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?mini=true&source=A workaround for R-Grass GIS 7 (co-interface) users in Mac OSX&summary=&url=http://avitbhowmik.ml/2016/07/04/dyld_grass/" target="_blank"><i class="fa fa-linkedin"></i></a></li><li><a href="https://www.stumbleupon.com/badge/?url=http://avitbhowmik.ml/2016/07/04/dyld_grass/" target="_blank"><i class="fa fa-stumbleupon"></i></a></li><li><a href="https://www.reddit.com/submit?url=http://avitbhowmik.ml/2016/07/04/dyld_grass/" target="_blank"><i class="fa fa-reddit-alien"></i></a></li><li><a href="https://www.tumblr.com/share/link?url=http://avitbhowmik.ml/2016/07/04/dyld_grass/" target="_blank"><i class="fa fa-tumblr"></i></a></li><li><a href="https://www.pinterest.com/pin/create/link/?description=&media=http://avitbhowmik.ml/assets/images/rgrass.jpg&url=http://avitbhowmik.ml/2016/07/04/dyld_grass/" target="_blank"><i class="fa fa-pinterest"></i></a></li></ul></div></div><div class="section-padding--none"><div class="grid"><hr class="sep"/></div></div><div class="section-padding"><div class="grid-small"> <span class="post__author">Posted by Avit K. Bhowmik</span><p class="post__bio"></p></div></div></article></div><section class="related section-padding"><div class="grid-xlarge"><h2 class="related__title">Related</h2><div class="related__container"><article class="related__post"> <a class="related__link" href="http://avitbhowmik.ml/2016/07/06/v_extract/"><figure class="related__img"> <img src="/assets/images/vraster.jpg" alt="Further problems with dynamic links for R-Grass GIS 7 users in Mac OSX"/></figure><div><h2 class="related__text">Further problems with dynamic links for R-Grass GIS 7 users in Mac OSX</h2></div></a></article><article class="related__post"> <a class="related__link" href="http://avitbhowmik.ml/2016/07/04/dyld_grass/"><figure class="related__img"> <img src="/assets/images/rgrass.jpg" alt="A workaround for R-Grass GIS 7 (co-interface) users in Mac OSX"/></figure><div><h2 class="related__text">A workaround for R-Grass GIS 7 (co-interface) users in Mac OSX</h2></div></a></article></div></div></section></main><footer class="footer section-padding"><div class="grid"><div class="subscribe" id="subscribe"><div class="subscribe__container"> <span class="subscribe__title">Subscribe</span><p class="subscribe__text">Get a weekly email of posts I‚Äôve added to the site.</p><form method="POST" action="https://samesies.us17.list-manage.com/subscribe/post-json?u=66ddf555dab480e6a8606430b&amp;id=89b3ee034f&amp;c=?" id="mc-signup" name="mc-embedded-subscribe-form" novalidate><div style="position: absolute; left: -5000px;" aria-hidden="true"> <input type="text" name="b_66ddf555dab480e6a8606430b_89b3ee034f" tabindex="-1" value=""></div><div class="form-group"> <input id="mce-EMAIL" type="email" name="EMAIL" placeholder="Email Address"></div><div class="form__btn"> <input id="mc-submit" type="submit" value="Sign Up" name="subscribe"></div></form><p class="subscribe__error hidden"></p></div></div><hr class="sep--white"/><div class="footer__container"><ul class="footer__tags"><li><a class="footer__link" href="/tag/sustainability">Sustainability</a></li><li><a class="footer__link" href="/tag/transformation">Transformation</a></li><li><a class="footer__link" href="/tag/exponential-climate-action">Exponential Climate Action</a></li><li><a class="footer__link" href="/tag/climate-action">Climate Action</a></li><li><a class="footer__link" href="/tag/climate-change">Climate Change</a></li></ul><ul class="footer__social"><li><a href="https://twitter.com/avitbhowmik" target="_blank"><i class="fa fa-twitter"></i></a></li><li><a href="https://www.kau.se/en/researchers/avit-kumar-bhowmik" target="_blank"><i class="fa fa-KarlstadUniversity"></i></a></li><li><a href="https://www.linkedin.com/in/avitbhowmik/" target="_blank"><i class="fa fa-linkedin"></i></a></li><li><a href="https://github.com/AvitBhowmik" target="_blank"><i class="fa fa-github"></i></a></li><li><a href="https://www.facebook.com/akbhowmik" target="_blank"><i class="fa fa-facebook"></i></a></li></ul></div></div></footer><section class="contact popup"><div class="popup__close"><div class="popup__exit"></div></div><div class="contact__container popup__container"><div class="contact__img"><figure class="absolute-bg" style="background-image: url(/assets/images/placeholder-28.jpg);"></figure></div><div class="contact__content"><div class="contact__mast section-padding--half"><div class="grid"><h2>Contact</h2></div><p> If you would like to get in touch, send me a comment or request a feature or an interview, please do so here.</p></div><div class="section-padding--none"><hr class="sep"/></div><div class="contact__form section-padding--half"><div class="grid-xlarge"> <form id="form" class="form" action="https://formcarry.com/s/HkIo0nMb7" method="POST"><div class="form__subcontainer"><div> <label for="form-first-name">First Name</label> <input type="text" name="first-name" id="form-first-name" required></div><div> <label for="form-last-name">Last Name</label> <input type="text" name="last-name" id="form-last-name" required></div></div><div> <label for="form-email">E-Mail</label> <input type="email" name="email" id="form-email" required></div><div> <label for="form-message">Message</label> <textarea name="message" id="form-message" rows="3"></textarea></div><div class="form__submit"><div class="form__btn"> <input type="submit" value="Send"></div></div><p class="form__message"></p></form></div></div></div></div></section><script src="/assets/js/app.min.js"></script></body></html>
  